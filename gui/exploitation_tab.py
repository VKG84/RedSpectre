from PyQt5.QtWidgets import QWidget, QVBoxLayout, QPushButton, QTextEdit, QLabel
from modules.exploit.msf_exploit_runner import run_msf_exploit

class ExploitationTab(QWidget):
    def __init__(self, result, target):
        super().__init__()
        self.result = result
        self.target = target
        self.initUI()

    def initUI(self):
        layout = QVBoxLayout()

        self.label = QLabel("Exploitations disponibles :")
        layout.addWidget(self.label)

        self.output = QTextEdit()
        self.output.setReadOnly(True)
        layout.addWidget(self.output)

        self.exploit_button = QPushButton("Lancer exploitation automatique")
        self.exploit_button.clicked.connect(self.run_exploit)
        layout.addWidget(self.exploit_button)

        self.setLayout(layout)

    def run_exploit(self):
        # Exemple de module générique — à adapter à un mapping CVE/module réel
        module_path = "exploit/unix/ftp/vsftpd_234_backdoor"
        rhost = self.target
        output = run_msf_exploit(module_path, rhost)
        self.output.append(output)
